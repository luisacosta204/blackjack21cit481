/* ---- Blackjack table + controls (cleaned + no-scroll layout) ----
   - De-duplicated rules
   - Viewport-fit layout using svh (stable viewport height)
   - Auto-scaling cards with clamp()
   - Compact vertical rhythm on short screens
*/

/* === Layout: keep everything inside the viewport === */
html, body {
    height: 100%;
}

main.container.stack {
    /* Fill the usable viewport and stack: [Table (flexes)] + [Controls] */
    min-height: 100svh;
    display: grid;
    grid-template-rows: 1fr auto;
    gap: var(--space-6, 24px);
}

    /* === Stick Actions panel to bottom === */
    main.container.stack > .grid.cols-2 {
        position: sticky;
        bottom: 0;
        z-index: 10;
        background: var(--panel, rgba(0, 0, 0, 0.6)); /* translucent backdrop for clarity */
        backdrop-filter: blur(8px);
        padding: var(--space-4, 16px) var(--space-6, 24px);
        border-top: 1px solid var(--border, rgba(255, 255, 255, 0.1));
        margin-top: auto;
    }

        /* Keep inner panels aligned and compact */
        main.container.stack > .grid.cols-2 .panel {
            background: transparent; /* inherit sticky backdrop */
            box-shadow: none;
            margin: 0;
            padding: 0;
        }

        main.container.stack > .grid.cols-2 .panel-header {
            margin-bottom: 4px;
        }


/* The felt/table takes remaining space inside the table panel */
.table-wrap {
    flex: 1 1 auto;
    min-height: 0;
    background: radial-gradient(800px 500px at 50% 30%, var(--felt-2, #143d2a), transparent);
    border: 1px solid var(--border, rgba(255,255,255,.08));
    border-radius: var(--radius, 14px);
    padding: var(--space-6, 24px);
    position: relative;
    overflow: hidden; /* keep cards inside when we scale */
}

    .table-wrap::after {
        content: "";
        position: absolute;
        inset: 0;
        pointer-events: none;
        background-image: radial-gradient(rgba(255,255,255,.06) 1px, transparent 1px);
        background-size: 20px 20px;
        mask-image: radial-gradient(70% 70% at 50% 40%, black, transparent);
    }

.row {
    display: grid;
    place-items: center;
    margin: var(--space-6, 24px) 0;
}

.hand {
    width: 100%;
    max-width: 980px;
}

.label {
    color: var(--muted, #9aa4a8);
    margin-bottom: 6px;
    font-weight: 700;
    letter-spacing: .3px;
}

.score {
    margin-top: 6px;
    color: var(--muted, #9aa4a8);
}

/* === Card sizing: scale to space so we avoid scrolling === */
/* Base sizing variables (auto-adjust with viewport). */
:root {
    /* Card width shrinks on smaller screens but caps for readability. */
    --card-w: clamp(70px, 8.2vw, 110px);
    --card-h: calc(var(--card-w) * 1.4);
    --card-gap: clamp(8px, 1.2vw, 14px);
}

/* On short screens, shrink more aggressively to stay within one view. */
@media (max-height: 800px) {
    :root {
        --card-w: clamp(64px, 7.2vw, 100px);
        --card-gap: clamp(6px, 1vw, 12px);
    }
}

@media (max-height: 680px) {
    :root {
        --card-w: clamp(58px, 6.8vw, 92px);
        --card-gap: clamp(4px, .9vw, 10px);
    }
}

.cards {
    display: grid;
    grid-auto-flow: column;
    grid-auto-columns: var(--card-w);
    gap: var(--card-gap);
    align-items: center;
}

/* When multiple hands are shown */
.player-hands {
    display: grid;
    gap: 18px;
}

.player-hand {
    padding: 8px;
    border-radius: 12px;
    transition: box-shadow .2s ease;
}

    .player-hand.active {
        box-shadow: 0 0 0 3px rgba(61,255,155,.35), var(--shadow-lg, 0 8px 30px rgba(0,0,0,.28));
    }

    .player-hand.finished {
        opacity: .88;
    }

/* === Card visuals === */
.card-ui {
    width: var(--card-w);
    height: var(--card-h);
    border-radius: 12px;
    background: var(--card, #111315);
    box-shadow: var(--shadow-lg, 0 8px 30px rgba(0,0,0,.28));
    display: grid;
    grid-template-rows: auto 1fr auto;
    padding: 10px;
    position: relative;
    user-select: none;
}

    .card-ui .corner {
        font-weight: 700;
        font-size: 16px;
    }

    .card-ui .center {
        display: grid;
        place-items: center;
        font-size: calc(var(--card-w) * 0.38);
    }

    .card-ui .red {
        color: #d22525;
    }

    .card-ui.back {
        background: linear-gradient(135deg,#1b1f1d,#0a0f0d);
        border: 1px solid var(--border-strong, rgba(255,255,255,.15));
        display: grid;
        place-items: center;
    }

        .card-ui.back::after {
            content: "★";
            opacity: .5;
            font-size: 28px;
        }

/* === Chips / betting === */
.chip-btn {
    width: 52px;
    height: 52px;
    border-radius: 999px;
    border: 0;
    cursor: pointer;
    font-weight: 800;
    background: linear-gradient(180deg,#f0d77a,#caa93b);
    box-shadow: var(--shadow-md, 0 4px 16px rgba(0,0,0,.22));
}

.chip-5 {
    filter: hue-rotate(-30deg) saturate(0.8);
}

.chip-25 {
    filter: hue-rotate(80deg) saturate(0.9);
}

.chip-100 {
    filter: hue-rotate(200deg) saturate(1);
}

.bet-line {
    display: flex;
    gap: 10px;
    align-items: baseline;
}

    .bet-line .muted {
        color: var(--muted, #9aa4a8);
    }

.select {
    padding: 8px 10px;
    border-radius: 10px;
    background: var(--panel, #0f1214);
    border: 1px solid var(--border, rgba(255,255,255,.08));
    color: inherit;
}

.header .select {
    height: 34px;
    padding: 4px 10px;
}

.header label.muted {
    margin: 0 6px 0 4px;
}


/* Header badge */
#bankBadge {
    font-size: 14px;
}

/* Utility states */
.win-glow {
    box-shadow: 0 0 0 3px rgba(61,255,155,.35), var(--shadow-lg, 0 8px 30px rgba(0,0,0,.28));
}

.lose-glow {
    box-shadow: 0 0 0 3px rgba(255,59,48,.35), var(--shadow-lg, 0 8px 30px rgba(0,0,0,.28));
}

/* === Compact mode on short screens: tighten vertical rhythm further === */
@media (max-height: 800px) {
    .row {
        margin: 14px 0;
    }

    .table-wrap {
        padding: 16px;
    }

    .panel .panel-header {
        margin-bottom: 6px;
    }

    .toast {
        margin-top: 10px;
    }
}

/* Phone portrait tweaks */
@media (max-width: 560px) {
    .cards {
        grid-auto-columns: calc(var(--card-w) - 10px);
        gap: 10px;
    }

    .card-ui {
        width: calc(var(--card-w) - 10px);
        height: calc((var(--card-w) - 10px) * 1.4);
    }
}

/* === Safe shrink for non-active hands (no transform, no button interference) === */
.player-hands[data-hands="2"] .player-hand:not(.active),
.player-hands[data-hands="3"] .player-hand:not(.active) {
    opacity: 0.8;
    filter: saturate(0.85);
}

    .player-hands[data-hands="2"] .player-hand:not(.active) .card-ui,
    .player-hands[data-hands="3"] .player-hand:not(.active) .card-ui {
        width: calc(var(--card-w) * 0.85);
        height: calc(var(--card-h) * 0.85);
    }

    .player-hands[data-hands="2"] .player-hand:not(.active) .cards {
        gap: calc(var(--card-gap) * 0.8);
    }

    .player-hands[data-hands="3"] .player-hand:not(.active) .cards {
        gap: calc(var(--card-gap) * 0.7);
    }

.player-hand.active {
    opacity: 1;
    filter: none;
    z-index: 2;
}

/* Maintain spacing balance */
.player-hands[data-hands="2"] .player-hand:not(.active),
.player-hands[data-hands="3"] .player-hand:not(.active) {
    margin-block: 4px;
}

/* Smooth transitions when changing active hand */
.player-hand {
    transition: opacity 0.25s ease, filter 0.25s ease;
}


/* Tighten internal spacing for shrunken hands */
.player-hands[data-hands="2"] .player-hand:not(.active) .cards {
    gap: calc(var(--card-gap) * .8);
}

.player-hands[data-hands="3"] .player-hand:not(.active) .cards {
    gap: calc(var(--card-gap) * .7);
}

/* Motion-friendly: respect reduced motion */
@media (prefers-reduced-motion: reduce) {
    .player-hand {
        transition: none !important;
    }
}

.player-hands[data-hands="2"] .player-hand:not(.active),
.player-hands[data-hands="3"] .player-hand:not(.active) {
    margin-block: 4px;
}

/* make image faces fill the card */
.card-ui {
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
}

.card-img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: inherit;
    user-select: none;
    pointer-events: none;
}


/* Back button styled like in-game buttons, aligned right */
.back-button {
    padding: 8px 16px;
    font-size: 15px;
    font-weight: 600;
    border-radius: 10px;
    cursor: pointer;
    transition: background-color 0.2s ease, transform 0.2s ease;
    background: var(--btn-bg, linear-gradient(180deg, #2e3438, #1a1d1f));
    color: var(--btn-fg, #fff);
    border: 1px solid rgba(255, 255, 255, 0.15);
    box-shadow: var(--shadow-md, 0 2px 8px rgba(0, 0, 0, 0.3));
    margin-right: 10px;
}

    .back-button:hover {
        background: var(--btn-bg-hover, linear-gradient(180deg, #3c4449, #23282b));
        transform: scale(1.05);
    }

/* Keeps header items vertically centered */
.header .right.cluster {
    display: flex;
    align-items: center;
    gap: 10px;
}

.header select#deckSelect {
    height: 32px;
    padding: 4px 10px;
    font-size: 14px;
}

#countLabel {
    font-weight: 700;
}
/* ==== Hi-Lo readout under Shoe ==== */
#countInfo {
    display: inline-block;
    margin-left: 6px;
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
    font-weight: 700;
    letter-spacing: 0.2px;
}

#countLabel {
    font-weight: 800;
    margin-left: 4px;
    transition: color 160ms ease, text-shadow 160ms ease, opacity 160ms ease;
    opacity: 0.95;
}

    /* Color states driven by data-state set in JS */
    #countLabel[data-state="Hot"] {
        color: #3dff9b; /* minty green */
        text-shadow: 0 0 12px rgba(61, 255, 155, 0.35);
    }

    #countLabel[data-state="Cold"] {
        color: #ff3b30; /* casino red */
        text-shadow: 0 0 12px rgba(255, 59, 48, 0.30);
    }

    #countLabel[data-state="Neutral"] {
        color: var(--muted, #9aa4a8); /* matches your muted text */
        text-shadow: none;
    }

/* Small spacing polish for the whole line */
.panel-subtle .muted + #shoeInfo + .muted {
    margin-left: 8px; /* space before " | Count:" */
}

/* Optional: make the “|” separator a dot on tiny screens */
@media (max-width: 460px) {
    .panel-subtle .muted:has(+ #shoeInfo) + .muted::before {
        content: "• ";
    }
}
